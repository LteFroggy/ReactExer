# Github UIì—ì„œ í‘œì‹œë  ì›Œí¬í”Œë¡œìš° ì´ë¦„
name: 3. Discord Webhook on Push

# ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±° ì„¤ì •
on:
  workflow_run:
    workflows: ["Mac SSH íŒŒì¼ ë³µì‚¬"]
    types:
      - completed

# ì‹¤í–‰í•  ì‘ì—…
jobs:
  notify-discord:
    runs-on: ubuntu-latest   # ì‹¤í–‰ OS í™˜ê²½ ì§€ì •!
    steps:
      - name: ë””ìŠ¤ì½”ë“œ ì„±ê³µ ì•Œë¦¼ ì „ì†¡
        if: ${{ github.event.workflow_run.conclusion == 'success' }}
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d '{"content":"ğŸš€ `${{ github.ref_name }}` ë¹Œë“œê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¡œê·¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."}' \
               ${{ secrets.DISCORD_WEBHOOK_URL }}

      - name: ë””ìŠ¤ì½”ë“œ ì‹¤íŒ¨ ì•Œë¦¼ ì „ì†¡
        if: ${{ github.event.workflow_run.conclusion == 'failure' }}
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d '{"content":"ğŸš€ `${{ github.ref_name }}` ì„±ê³µì ìœ¼ë¡œ ë¹Œë“œí–ˆê³ , EC2ì— ë°°í¬í–ˆìŠµë‹ˆë‹¤!"}' \
               ${{ secrets.DISCORD_WEBHOOK_URL }}